# 视频 AI 助手详细需求说明

## 1. 产品概述
- **定位**：面向视频创作者的 AI 辅助创作平台，帮助用户将简短想法或大纲扩展为完整的脚本、分镜与可剪辑素材。
- **核心价值**：统一脚本、分镜、语音、视频、音乐等资产的生成与管理流程，缩短从灵感到可剪素材的时间。
- **目标平台**：Web 端优先，后续可扩展桌面客户端。

### 技术栈
- **前端**：Angular，采用组件化架构与 RxJS 状态流，集成国际化与富文本编辑能力。
- **后端**：Python + FastAPI（REST/GraphQL 接口）、SQLAlchemy（ORM）、Celery（异步任务调度）。
- **数据与缓存**：PostgreSQL（主存储）、Redis（缓存/任务队列）。
- **日志与监控**：colorlog 统一日志格式，结合 observability 平台（预留）。
- **文件存储**：S3 兼容对象存储或本地挂载，后续可配置。

## 2. 用户与角色
- **创作者**：项目拥有者，具备全部创作与导出权限。
- **协作者（预留）**：受邀编辑指定项目，可创建、编辑、生成、上传素材，但无删除项目权限。
- **管理员（预留）**：平台级用户与配额管理、系统配置、监控。

## 3. 业务流程
1. 创作者新建项目并填写基础信息。
2. 输入简要文本或教学大纲，调用大模型扩写为完整脚本。
3. 审核脚本后自动或手动拆分分镜，形成镜头列表。
4. 在每个镜头工作台内生成/上传视频、语音、音乐等资产。
5. 资产确认后导出 AE/PR 等剪辑软件可用的时间线包和素材压缩包。
6.（后续版本）一键上传到视频平台，监控上传状态。

## 4. 功能需求
### 4.1 项目管理
- 支持创建、重命名、归档、删除项目，记录创建人与时间戳。
- 维护项目元信息：标题、简介、标签、目标平台、语言、封面、状态等。
- 提供仪表盘展示脚本、分镜、资产完成度以及最近活动。
- 支持项目级协作者邀请（预留）。

### 4.2 脚本生成与管理
- 输入不少于 200 字的创意描述或教学大纲，调用大模型扩写为完整故事脚本。
- 脚本需包含场景名称、情节描述、角色对话、情绪与预计时长等字段。
- 提供在线编辑器、版本历史、差异查看、回滚功能。
- 可对脚本片段设置“锁定/需修改”状态以提示分镜环节。

### 4.3 分镜创建与管理
- 从脚本一键生成分镜草稿，或手动新增镜头。
- 每个镜头记录：镜头 ID、标题、脚本文本、视觉描述、景别、镜头类型、预计时长、所需资产列表、备注。
- 提供拖拽排序与批量状态更新（未开始/制作中/已完成）。
- 支持镜头版本化与评论讨论。

### 4.4 镜头工作台与资产生成
- 镜头工作台需展示脚本片段、参考图/提示词、资产面板。
- 可调用 AI 生成或本地上传：
  - 视频/图像（mp4、mov、jpg、png）。
  - 语音（TTS，多种声音与语速），支持自定义台词。
  - 背景音乐/环境音（mp3、wav），支持循环与淡入淡出设置。
- 生成任务需显示进度、失败重试、参数记录。
- 允许对资产打标签（草稿/待修/已通过）并添加备注。

### 4.5 资产管理与存储
- 所有资产按 `projects/{project_id}/shots/{shot_id}/` 结构保存，自动生成规范命名。
- 记录资产元信息：类型、格式、分辨率、帧率/采样率、时长、大小、生成参数。
- 支持单资产下载、镜头级批量下载、镜头复制/复用。
- 配额与限制：可配置最大单文件大小、项目总空间、生成次数。
- 生成/上传完成后自动更新项目仪表盘统计。

### 4.6 导出与集成
- 一键导出 Adobe Premiere Pro / After Effects 兼容的时间线包（XML/JSON/CSV）。
- 导出内容需包含镜头顺序、时间码、轨道、素材相对路径、转场信息。
- 支持生成 ZIP 包，包含时间线文件与引用素材，便于离线交付。
- 记录导出历史、参数与下载链接。

### 4.7 平台上传（后续版本）
- 预留 UI，支持配置目标平台（YouTube、Bilibili、抖音等）及账号授权。
- 存储 OAuth 凭证并加密管理，允许解绑。
- 上传作业入队后显示进度、失败重试、日志。
- 可选择导出的时间线或最终视频作为上传源。

## 5. 非功能需求
- **可用性**：自适应布局、键盘快捷键、自动保存间隔 ≤30 秒且提供状态提示。
- **性能**：脚本/分镜生成平均耗时 <10 秒；文件上传展示实时进度与剩余时间。
- **可扩展性**：单用户支持≥100 个并行项目；存储需可扩展至 S3 兼容对象存储。
- **可靠性**：所有资产与文本版本化保存，支持软删除并保留 30 天；关键任务具备重试机制。
- **安全性**：项目级权限隔离、细粒度角色校验、签名下载链接、全量操作审计日志。

## 6. 数据模型与接口概要
- **核心实体**：Project、ScriptVersion、Shot、Asset、ExportPackage、UploadJob。
- **关键字段**：ID、所属项目、状态、创建/更新人、时间戳、元数据 JSON。
- **API 要求**：
  - 统一 REST/GraphQL 接口，支持分页、搜索、过滤。
  - Webhook/事件：脚本生成完成、镜头状态变化、导出完成、上传成功/失败。
  - 统一认证：短期 JWT + 刷新令牌；外部平台上传使用 OAuth。

## 7. 安全与合规
- 存储路径隔离，防止跨项目读取。
- 大模型调用需脱敏处理，避免敏感信息泄露。
- 记录所有生成、下载、导出、上传等关键操作；支持审计查询。
- 符合常见隐私法规（如 GDPR/数据本地化需求）时的最小化收集策略。

## 8. 里程碑规划
1. **MVP**：项目管理、脚本生成与编辑、分镜创建、手动素材上传。
2. **镜头工作台增强**：AI 生成多媒体、资产状态管理、自动存储结构。
3. **导出自动化**：AE/PR 时间线导出、ZIP 打包、导出历史。
4. **平台上传 Beta**：OAuth 集成、上传队列、进度监控、失败重试。

## 9. 风险与待定事项
- 大模型与多媒体生成成本与延迟需评估（可考虑缓存与分级模型）。
- 平台上传涉及不同平台接口差异，需提前调研限制。
- 需确认是否有离线/桌面版需求以及素材本地缓存策略。
- 数据合规与用户隐私策略需结合目标市场法规进一步细化。
